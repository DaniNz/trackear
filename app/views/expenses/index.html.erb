<div class="d-flex justify-content-between">
  <div class="d-flex">
    <h4 class="mt-2">Expenses</h4>
    <div class="ml-2">
      <%= link_to new_expense_path, class: "btn btn-sm btn-primary" do %>
        <%= icon "fas", "wallet", class: "mr-1" %>
        Create expense
      <% end %>
      <%= render 'invite_people_button' %>
    </div>
  </div>
  <div class="">
    <div id="dateFilter"></div>
  </div>
</div>

<% if @expenses_invited_to.present? %>
  <%= form_with(url: expenses_path, model: @invitation, local: true, method: :get) do |form| %>
    <div class="form-group">
      <%= form.label :id, "Seeings expenses from" %>
      <%= form.select :id,
        @expenses_invited_to.collect { |invitation| [invitation.user.first_name, invitation.id] },
        { include_blank: "You" },
        { class: "form-control", onchange: "this.form.submit()" }
      %>
    </div>
  <% end %>
<% end %>

<% if @invitations.present? %>
<small>Invitations: </small>
<% end %>
<% @invitations.each do |invitation| %>
<div class="mr-2 badge badge-pill badge-secondary">
  <%= invitation.name + " (" + invitation.email + ")" %>
</div>
<% end %>

<% if @expenses.empty? %>
<div class="p-4 text-center">
  <p class="lead">No expenses found </p>
  <%= link_to "Create one", new_expense_path, class: "btn btn-orange" %>
</div>
<% end %>

<% @expenses.each do |expense| %>
<div class="box mt-2 mb-3">
  <div class="row align-items-center">
    <div class="col-lg-3">
      <h5 class="m-0">
        <%= link_to edit_expense_path(expense) do %>
          <%= icon "fa", "edit" %>
          <%= expense.name %>
        <% end %>
      </h5>
    </div>

    <div class="col-lg-2">
      <%= link_to "Download receipt", download_expense_path(expense), class: "btn btn-outline-secondary btn-sm py-1" %>
    </div>

    <div class="col-lg-2">
      <%= link_to "Delete", expense, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-sm btn-outline-danger py-1" %>
    </div>

    <div class="col-lg-2">
      <span class="lead text-dark">
        <%= expense.from.strftime "%d %b %Y" %>
      </span>
    </div>

    <div class="col-lg-3 text-right">
      <span class="lead text-dark">
        <%= humanized_money_with_symbol(expense.price) %>
      </span>
    </div>
  </div>
</div>
<% end %>

<div class="mt-2">
  <%= will_paginate @expenses %>
</div>

<% if @all_expenses.present? %>
<div class="mt-2 lead text-right">
  Total amount in expenses for selected period: <%= humanized_money_with_symbol(calculate_total(@all_expenses)) %>
</div>
<% end %>