<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">Home</a></li>
    <li class="breadcrumb-item"><%= link_to @project.name, @project %></li>
    <li class="breadcrumb-item active" aria-current="page">Invoices</li>
  </ol>
</nav>

<div class="box">
  <h6>Invoices</h6>
  <% unless @invoices.present? %>
  <p class="lead text-center">
    <%= "Nothing to be displayed here..." %>
  </p>
  <% else %>
  <table class="table border">
    <thead class="thead-light">
      <tr>
        <th scope="col">#</th>
        <% if current_user.is_admin? %>
        <th scope="col">From</th>
        <th scope="col">Is for client</th>
        <th scope="col">Is visible</th>
        <% end %>
        <th scope="col">Month</th>
        <th scope="col">Year</th>
        <th scope="col">Amount</th>
        <th scope="col">Discount</th>
        <th scope="col" class="text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @invoices.each.with_index(1) do |invoice, index| %>
        <tr>
          <th class="align-middle" scope="row"><%= index %></th>
          <% if current_user.is_admin? %>
          <td class="align-middle"><%= image_tag (invoice.user.picture || ""), class: "avatar align-self-center mr-2" %> <%= invoice.user.first_name %></td>
          <td class="align-middle"><%= invoice.is_client_visible? ? "Yes" : "No" %></td>
          <td class="align-middle"><%= invoice.is_visible? ? "Yes" : "No" %></td>
          <% end %>
          <td class="align-middle"><%= invoice.from.strftime("%B") %></td>
          <td class="align-middle"><%= invoice.from.strftime("%Y") %></td>
          <td class="align-middle"><%= humanized_money_with_currency(invoice.calculate_total, invoice.currency) %></td>
          <td class="align-middle"><%= invoice.discount_percentage %>%</td>
          <td class="align-middle text-center">
            <%= render 'action_dropdown', invoice: invoice, user: current_user %>
          </td>
        </th>
      <% end %>
    </tbody>
  </table>
  <% end %>

  <% unless @project.is_client? current_user %>
    <%= link_to "Create invoice", new_project_invoice_path(@project), class: "btn btn-primary" %>
  <% end %>
</div>
