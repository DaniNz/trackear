<div class="d-flex justify-content-between">
    <h4 class="mt-2">Invoices</h4>
    <div class="d-flex justify-content-end">
        <% unless project.is_client? current_user %>
            <%= link_to new_project_invoice_path(project), class: "btn btn-sm btn-primary" do %>
                <%= icon "far", "file-alt", class: "mr-1" %>
                Create invoice
            <% end %>
        <% end %>
    </div>
</div>
<% unless invoices.present? %>
    <div class="box text-center mt-2 mb-3">
        <p class="lead mb-0">No invoices found...</p>
    </div>
<% else %>
    <% invoices.each do |invoice| %>
        <div class="box mt-2 mb-3">
            <div class="media">
                <%= image_tag invoice.user.avatar_or_default, class: "avatar align-self-start mr-3" %>
                <div class="media-body">
                    <h5 class="mt-1 m-0">
                        <%= invoice.user.first_name %> <%= invoice.user.last_name %>
                        <% if invoice.is_paid? %>
                            <span class="badge badge-success">Paid</span>
                        <% end %>

                        <% if invoice.is_unpaid? %>
                            <span class="badge badge-warning">Unpaid</span>
                        <% end %>
                    </h5>
                    <p class="mb-0">
                        <%= humanized_invoice_period(invoice) %> - <%= humanized_money_with_currency(invoice.calculate_total, invoice.currency) %>
                    </p>
                </div>
                <div class="align-self-start">
                    <%= render 'invoices/action_dropdown', invoice: invoice, user: current_user %>
                </div>
            </div>
            <div class="mt-4 d-flex justify-content-end">
                <% if invoice.invoice.present? %>
                    <%= link_to("Download invoice", download_invoice_project_invoice_path(invoice.project, invoice), class: "mx-2 border btn btn-sm py-2 px-4") %>
                <% else %>
                    <button data-toggle="tooltip" title="You will be able to download the invoice once it gets uploaded" class="disabled mx-2 border btn btn-sm py-2 px-4" type="button">Download invoice</button>
                <% end %>

                <% if invoice.payment.present? %>
                    <%= link_to("Download payment", download_payment_project_invoice_path(invoice.project, invoice), class: "mx-2 border btn btn-sm py-2 px-4") %>
                <% else %>
                    <button data-toggle="tooltip" title="You will be able to download the payment receipt once it gets uploaded" class="disabled mx-2 border btn btn-sm py-2 px-4" type="button">Download receipt</button>
                <% end %>
            </div>
        </div>
    <% end %>
<% end %>